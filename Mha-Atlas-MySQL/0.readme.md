# Mha-Atlas-MySQL高可用方案实践

​	在许多比较重要的系统中，基本上都是24h*365d不间断运行的。

​	对于应用程序来讲，可以做`haproxy+app` 或 `nginx+app`的集群。好，问题来了，当应用程序的性能调优后，那么瓶颈就卡在数据库上。这个时候，就要对数据库进行优化。

​	在进行去IOE后，基本上许多的数据库都采用的是开源的`mysql`数据库。

​	当并发较高或数据量比较大的时候，数据库的瓶颈就会成为制约应用的关键。此时，我们会通过做`mysql`主从机读写分离（主节点master负责写，从节点slave负责读），再对主机进行[双机热备](https://www.baidu.com/s?wd=%E5%8F%8C%E6%9C%BA%E7%83%AD%E5%A4%87&tn=24004469_oem_dg&rsv_dl=gh_pl_sl_csd)（当主节点宕机后，自动切换到另一备用节点上），对从节点做集群（读取数据分离到不同的节点上，以减小读数据库的压力）。

​	这里在做主从读写分离是用qihoo的atlas。在mysql做故障转移是用mha。对数据库主备节点做故障切换则是用keepalived。



## 高可用性

​	很多公司的服务都是24小时*365天不间断的。这就要求高可用性。再比如购物网站，必须随时都可以交易。那么当购物网的server挂了一个的时候，不能对业务产生任何影响。这就是高可用性。

​	当服务器down掉，或者出现错误的时候，可以自动的切换到其他待命的服务器，不影响服务器上App的运行。



## 读写分离

​	随着一个网站的业务不断扩展，数据不断增加，数据库的压力也会越来越大，对数据库或者SQL的基本优化可能达不到最终的效果，我们可以采用读写分离的策 略来改变现状。

​	读写分离简单的说是把对数据库读和写的操作分开对应不同的数据库服务器，这样能有效地减轻数据库压力，也能减轻io压力。主数据库提供写操作，从数据库提 供读操作，其实在很多系统中，主要是读的操作。当主数据库进行写操作时，数据要同步到从的数据库，这样才能有效保证数据库完整性。